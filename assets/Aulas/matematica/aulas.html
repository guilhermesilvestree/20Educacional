<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Matemática | Evolução Educacional</title>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">

    <style>
        :root {
            --cor-fundo: #0A0A10;
            --cor-texto: #EAEAEA;
            --cor-sutil: #888;
            --cor-container: rgba(26, 26, 46, 0.7);
            --cor-borda-padrao: rgba(255, 255, 255, 0.15);
            --cor-botao-fundo: #FFFFFF;
            --cor-botao-texto: #0A0A10;
            
            --cor-matematica: #4CAF50;
            --cor-visitado: #27ae60;
            --cor-revisao-1: #007AFF;
            --cor-revisao-2: #FF9500;
            --cor-revisao-final: #AF52DE;
            --cor-concluido: #5856D6;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Poppins', sans-serif;
            background-color: var(--cor-fundo);
            color: var(--cor-texto);
            overflow-x: hidden;
        }
        
        #constellation-background {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
        }

        .page-container {
            width: 100%;
            max-width: 900px;
            margin: 0 auto;
            padding: 30px;
            position: relative;
            z-index: 1;
        }
        
        .back-button {
            position: fixed;
            top: 30px;
            left: 30px;
            z-index: 100;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            background: var(--cor-botao-fundo);
            color: var(--cor-botao-texto);
            padding: 10px 15px;
            border-radius: 50px;
            text-decoration: none;
            font-weight: 600;
            border: 1px solid rgba(0,0,0,0.1);
            transition: all 0.3s ease;
        }

        .back-button:hover { 
            transform: scale(1.05);
            box-shadow: 0 4px 20px rgba(255, 255, 255, 0.2);
        }
        .back-button .icon { stroke: var(--cor-botao-texto); }

        header h1 {
            font-size: 2.8rem;
            font-weight: 700;
            margin-bottom: 60px;
            text-align: center;
            color: var(--cor-matematica);
            text-shadow: 0 0 15px var(--cor-matematica);
        }

        .lessons-track {
            position: relative;
            width: 100%;
            display: grid;
            /* CORREÇÃO: Grid fixo com 4 colunas */
            grid-template-columns: repeat(4, 1fr);
            grid-auto-rows: 180px;
            align-items: center;
            justify-items: center;
        }
        
        #track-lines {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 0;
            overflow: visible;
        }
        
        .lesson-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            z-index: 1;
            position: relative;
        }

        .lesson-circle {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            border: 2px solid var(--cor-borda-padrao);
            font-size: 1.5rem;
            font-weight: 600;
            text-decoration: none;
            color: var(--cor-texto); /* Texto branco para melhor contraste com planetas */
            text-shadow: 0 0 5px rgba(0,0,0,0.5);
            transition: all 0.3s ease;
            margin-bottom: 10px;
            position: relative;
            overflow: hidden;
            box-shadow: inset 0 0 20px rgba(0,0,0,0.3), 0 5px 15px rgba(0,0,0,0.3);
        }
        .lesson-circle:hover { transform: scale(1.15); }
        
        /* NOVOS ESTILOS DE PLANETAS - Tema NASA/SpaceX */
        .planet-1 { background: radial-gradient(circle at 20% 20%, #ff8a00, #e52e71); } /* Sol/Marte */
        .planet-2 { background: radial-gradient(circle at 70% 70%, #00c6ff, #0072ff); } /* Terra/Netuno */
        .planet-3 { background: radial-gradient(circle at 30% 70%, #fdfcfb, #e2d1c3); } /* Lua/Metálico */
        .planet-4 { background: radial-gradient(circle at 80% 30%, #a770ef, #cf8bf3, #fdb99b); } /* Nebulosa/Júpiter */

        .lesson-title {
            font-size: 0.8rem;
            font-weight: 500;
            color: var(--cor-sutil);
            width: 120px;
        }

        .lesson-status {
            font-size: 0.75rem;
            font-weight: 500;
            height: 20px;
            margin-top: 4px;
        }

        .lesson-item.locked {
            opacity: 0.4;
            filter: grayscale(80%);
        }
        .lesson-item.locked .lesson-circle {
            cursor: not-allowed;
            background: #333;
        }

        .lesson-item.visited .lesson-circle { border-color: var(--cor-visitado); }
        .lesson-item.visited .lesson-status { color: var(--cor-visitado); }
        .lesson-item.review1-due .lesson-circle { border-color: var(--cor-revisao-1); box-shadow: 0 0 20px var(--cor-revisao-1); }
        .lesson-item.review1-due .lesson-status { color: var(--cor-revisao-1); }
        .lesson-item.review2-due .lesson-circle { border-color: var(--cor-revisao-2); box-shadow: 0 0 20px var(--cor-revisao-2); }
        .lesson-item.review2-due .lesson-status { color: var(--cor-revisao-2); }
        .lesson-item.review-final-due .lesson-circle { border-color: var(--cor-revisao-final); box-shadow: 0 0 20px var(--cor-revisao-final); }
        .lesson-item.review-final-due .lesson-status { color: var(--cor-revisao-final); }
        .lesson-item.completed .lesson-circle { border: 4px solid var(--cor-concluido); opacity: 0.7; }
        .lesson-item.completed .lesson-title { color: var(--cor-concluido); }
        .lesson-item.completed .lesson-status { color: var(--cor-concluido); }
    </style>
</head>
<body>
    <canvas id="constellation-background"></canvas>

    <div class="page-container">
        <a href="../menu.html" class="back-button">
            <svg class="icon" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><polyline points="15 18 9 12 15 6"></polyline></svg>
            <span>Voltar</span>
        </a>

        <header>
            <h1>Matemática</h1>
        </header>

        <main>
            <div class="lessons-track" id="lessons-track">
                <svg id="track-lines"></svg>
            </div>
        </main>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const track = document.getElementById('lessons-track');
            const svgLines = document.getElementById('track-lines');
            const storageKey = 'evolucao_lesson_status_math_v1';
            const MS_IN_HOUR = 60 * 60 * 1000;
            const MS_IN_DAY = 24 * MS_IN_HOUR;

            const lessonTitles = [ "Adição e Subtração", "Multiplicação e Divisão", "Múltiplos e Divisores", "Cálculo de MMC e MDC", "Problemas com MMC", "Problemas com MDC", "Frações e Decimais", "Base da Porcentagem", "Acréscimos e Descontos", "Descontos Sucessivos", "Variação Percentual", "Porcentagem Reversa", "Razão e Proporção", "Propriedade Fundamental", "Grandezas Diretas", "Grandezas Inversas", "Divisão Proporcional", "Regra de Três Simples", "Problemas (R3 Simples)", "Regra de Três Composta", "Problemas (R3 Composta)", "Revisão Regra de Três", "Conceitos de Escalas", "Cálculo com Escalas", "Escala de Área e Volume", "Problemas de Escala", "Conversão: Comprimento", "Conversão: Área", "Conversão: Volume", "Conversão: Tempo", "Prop. da Potenciação", "Prop. da Radiciação", "Racionalização", "Notação Científica", "Ordem de Grandeza", "Ângulos e Retas", "Polígonos", "Classificação de Triângulos", "Semelhança de Triângulos", "Teorema de Tales", "Teorema de Pitágoras", "Aplicações de Pitágoras", "Relações Métricas", "Trigonometria Básica", "Ângulos Notáveis", "Problemas de Trigonometria", "Circunferência e Círculo", "Ângulos na Circunferência", "Áreas de Quadriláteros", "Áreas de Triângulos", "Áreas Compostas", "Vistas Ortogonais", "Planificação de Sólidos", "Volume de Prismas", "Volume de Cilindros", "Problemas de Volume", "Volume de Pirâmides", "Volume de Cones", "Troncos de Sólidos", "Volume da Esfera", "Introdução a Funções", "Análise Gráfica", "Função Afim (1º Grau)", "Coeficientes da Reta", "Modelagem (Função Afim)", "Problemas (Função Afim)", "Função Quadrática (2º Grau)", "Raízes e Vértice", "Máximo e Mínimo", "Problemas (Função Quadrática)", "Função Exponencial", "Modelagem Exponencial", "Problemas Exponenciais", "Função Logarítmica", "Aplicações de Log", "Leitura de Tabelas", "Gráficos de Barras", "Gráficos de Linhas/Setores", "Inferência com Gráficos", "Média Simples e Ponderada", "Moda", "Mediana", "Média, Moda ou Mediana?", "Desvio Padrão (Conceito)", "Interpretação do Desvio", "Princípio da Contagem", "Aplicações do PFC", "Permutação Simples", "Arranjo vs Combinação", "Problemas de Combinação", "Probabilidade Simples", "Problemas de Probabilidade", "Evento Complementar", "União de Eventos", "Probabilidade Condicional", "Revisão: Aritmética", "Revisão: Geometria", "Revisão: Funções", "Simulado Final", "Análise de Erros" ];

            const lessonElements = [];

            function generateLessons() {
                const cols = 4;
                for (let i = 0; i < 100; i++) {
                    const lessonId = `mat-${i + 1}`;
                    const row = Math.floor(i / cols) + 1;
                    
                    let col;
                    if (row % 2 !== 0) {
                        col = (i % cols) + 1;
                    } else {
                        col = cols - (i % cols);
                    }

                    const item = document.createElement('div');
                    item.className = 'lesson-item';
                    item.dataset.lessonId = lessonId;
                    item.style.gridRow = row;
                    item.style.gridColumn = col;

                    const link = document.createElement('a');
                    link.href = `aula${i + 1}.html`;
                    link.className = `lesson-circle planet-${(i % 4) + 1}`;
                    link.textContent = i + 1;
                    
                    const title = document.createElement('p');
                    title.className = 'lesson-title';
                    title.textContent = lessonTitles[i] || `Aula ${i + 1}`;

                    const status = document.createElement('p');
                    status.className = 'lesson-status';
                    
                    item.appendChild(link);
                    item.appendChild(title);
                    item.appendChild(status);
                    track.appendChild(item);
                    lessonElements.push(item);
                }
            }
            
            function drawTrackLines() {
                svgLines.innerHTML = '';
                for(let i = 0; i < lessonElements.length - 1; i++) {
                    const startElem = lessonElements[i];
                    const endElem = lessonElements[i+1];

                    const x1 = startElem.offsetLeft + startElem.offsetWidth / 2;
                    const y1 = startElem.offsetTop + startElem.querySelector('.lesson-circle').offsetHeight / 2;
                    const x2 = endElem.offsetLeft + endElem.offsetWidth / 2;
                    const y2 = endElem.offsetTop + endElem.querySelector('.lesson-circle').offsetHeight / 2;

                    const path = document.createElementNS('http://www.w3.org/2000/svg', 'path');
                    path.setAttribute('d', `M${x1} ${y1} C ${x1} ${y1 + 80}, ${x2} ${y2 - 80}, ${x2} ${y2}`);
                    path.setAttribute('stroke', 'rgba(255,255,255,0.1)');
                    path.setAttribute('stroke-width', '3');
                    path.setAttribute('fill', 'none');
                    svgLines.appendChild(path);
                }
            }

            function getStatusData() { return JSON.parse(localStorage.getItem(storageKey) || '{}'); }
            function saveStatusData(data) { localStorage.setItem(storageKey, JSON.stringify(data)); }
            
            function formatTimeAgo(ms) { const hours = Math.round(ms / MS_IN_HOUR); if (hours < 24) return `há ${hours}h`; const days = Math.round(hours / 24); return `há ${days}d`; }
            
            function checkAndUpdateUI() {
                const statusData = getStatusData();
                const now = Date.now();
                let highestCompletedLesson = 0;
                for (let i = 1; i <= 100; i++) {
                    if (statusData[`mat-${i}`]) {
                        highestCompletedLesson = i;
                    }
                }

                const allItems = document.querySelectorAll('.lesson-item');
                allItems.forEach((item, index) => {
                    const lessonNumber = index + 1;
                    const lessonId = item.dataset.lessonId;
                    const data = statusData[lessonId];
                    const statusText = item.querySelector('.lesson-status');

                    item.className = 'lesson-item';
                    statusText.textContent = '';
                    
                    if (data) {
                        const timeElapsed = now - data.timestamp;
                        let currentState = data.state;
                        if (currentState === 'visited' && timeElapsed > MS_IN_DAY) { currentState = 'review1-due'; }
                        else if (currentState === 'review1-done' && timeElapsed > 7 * MS_IN_DAY) { currentState = 'review2-due'; }
                        else if (currentState === 'review2-done' && timeElapsed > 30 * MS_IN_DAY) { currentState = 'review-final-due'; }
                        item.classList.add(currentState);
                        switch (currentState) {
                            case 'visited': statusText.textContent = formatTimeAgo(timeElapsed); break;
                            case 'review1-due': statusText.textContent = 'Revisão 1'; break;
                            case 'review1-done': statusText.textContent = `R1 feita ${formatTimeAgo(timeElapsed)}`; break;
                            case 'review2-due': statusText.textContent = 'Revisão 2'; break;
                            case 'review2-done': statusText.textContent = `R2 feita ${formatTimeAgo(timeElapsed)}`; break;
                            case 'review-final-due': statusText.textContent = 'Revisão Final'; break;
                            case 'completed': statusText.textContent = 'Aula Concluída'; break;
                        }
                    }

                    if (lessonNumber > highestCompletedLesson + 1) {
                        item.classList.add('locked');
                        item.querySelector('a').removeAttribute('href');
                    } else {
                        item.classList.remove('locked');
                        item.querySelector('a').href = `aula${lessonNumber}.html`;
                    }
                });
            }
            
            track.addEventListener('click', (event) => {
                const item = event.target.closest('.lesson-item');
                if (!item || item.classList.contains('locked')) {
                    event.preventDefault();
                    return;
                }
                event.preventDefault(); 
                const lessonId = item.dataset.lessonId;
                const statusData = getStatusData();
                const currentData = statusData[lessonId] || {};
                let nextState = currentData.state;
                switch (currentData.state) {
                    case undefined: nextState = 'visited'; break;
                    case 'review1-due': nextState = 'review1-done'; break;
                    case 'review2-due': nextState = 'review2-done'; break;
                    case 'review-final-due': nextState = 'completed'; break;
                    default: break;
                }
                statusData[lessonId] = { state: nextState || 'visited', timestamp: Date.now() };
                saveStatusData(statusData);
                setTimeout(() => { window.location.href = item.querySelector('.lesson-circle').href; }, 100);
            });

            generateLessons();
            checkAndUpdateUI();
            
            setTimeout(() => {
                drawTrackLines();
                window.addEventListener('resize', drawTrackLines);
            }, 100); 
            
            const canvas = document.getElementById('constellation-background');
            if (canvas) { /* ... código da animação de partículas ... */ }
        });
    </script>
    <script>
        // Script da animação de partículas
        const canvas = document.getElementById('constellation-background'); if (canvas) { const ctx = canvas.getContext('2d'); canvas.width = window.innerWidth; canvas.height = window.innerHeight; let particlesArray = []; class Particle { constructor() { this.x = Math.random() * canvas.width; this.y = Math.random() * canvas.height; this.directionX = (Math.random() * 0.4) - 0.2; this.directionY = (Math.random() * 0.4) - 0.2; this.size = Math.random() * 2 + 1; this.color = `hsl(${Math.random() * 360}, 90%, 65%)`; } draw() { ctx.beginPath(); ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2); ctx.fillStyle = this.color; ctx.fill(); } update() { if (this.x > canvas.width || this.x < 0) this.directionX = -this.directionX; if (this.y > canvas.height || this.y < 0) this.directionY = -this.directionY; this.x += this.directionX; this.y += this.directionY; this.draw(); } } function init() { particlesArray = []; let n = (canvas.height * canvas.width) / 15000; for (let i = 0; i < n; i++) { particlesArray.push(new Particle()); } } function connect() { let opacityValue = 1; for (let a = 0; a < particlesArray.length; a++) { for (let b = a; b < particlesArray.length; b++) { let distance = Math.sqrt(Math.pow(particlesArray[a].x - particlesArray[b].x, 2) + Math.pow(particlesArray[a].y - particlesArray[b].y, 2)); if (distance < 150) { opacityValue = 1 - (distance / 150); ctx.strokeStyle = `rgba(${hexToRgb(particlesArray[a].color)}, ${opacityValue})`; ctx.lineWidth = 1; ctx.beginPath(); ctx.moveTo(particlesArray[a].x, particlesArray[a].y); ctx.lineTo(particlesArray[b].x, particlesArray[b].y); ctx.stroke(); } } } } function hexToRgb(hsl) { let sep = hsl.indexOf(",") > -1 ? "," : " "; hsl = hsl.substr(4).split(")")[0].split(sep); let h = hsl[0], s = hsl[1].substr(0, hsl[1].length - 1) / 100, l = hsl[2].substr(0, hsl[2].length - 1) / 100; let c = (1 - Math.abs(2 * l - 1)) * s, x = c * (1 - Math.abs((h / 60) % 2 - 1)), m = l - c / 2, r = 0, g = 0, b = 0; if (0 <= h && h < 60) { r = c; g = x; b = 0; } else if (60 <= h && h < 120) { r = x; g = c; b = 0; } else if (120 <= h && h < 180) { r = 0; g = c; b = x; } else if (180 <= h && h < 240) { r = 0; g = x; b = c; } else if (240 <= h && h < 300) { r = x; g = 0; b = c; } else if (300 <= h && h < 360) { r = c; g = 0; b = x; } r = Math.round((r + m) * 255); g = Math.round((g + m) * 255); b = Math.round((b + m) * 255); return r + "," + g + "," + b; } function animate() { ctx.clearRect(0, 0, canvas.width, canvas.height); for (let i = 0; i < particlesArray.length; i++) { particlesArray[i].update(); } connect(); requestAnimationFrame(animate); } init(); animate(); window.addEventListener('resize', () => { canvas.width = window.innerWidth; canvas.height = window.innerHeight; init(); }); }
    </script>
</body>
</html>